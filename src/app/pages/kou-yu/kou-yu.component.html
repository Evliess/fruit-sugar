<div class="container">
  <div class="list-container">
    @if(isCustom) {
    <div class="custom-input-section">
      <input nz-input [(ngModel)]="userWord" placeholder="è¾“å…¥å¥å­ï¼Œç‚¹å‡»æ·»åŠ æŒ‰é’®ï¼Œå³å¯å®Œæˆå½•å…¥ï¼" />
      <button nz-button nzType="primary" (click)="addCustom(userWord)" [nzLoading]="isLoading" nz-tooltip
        nzTooltipTitle="æ·»åŠ ">
        <span nz-icon nzType="plus"></span> æ·»åŠ 
      </button>
    </div>
    }

    <div nz-row [nzGutter]="[16, 16]">
      @for (item of firstSentences; track item.id) {
      <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="12" [nzLg]="8" [nzXl]="8" [nzXXl]="8">
        <nz-card 
          [class.is-known]="item.isKnown" 
          [nzHoverable]="true"
          appHoverSound 
          (soundClick)="handleSound(item, 'us')">
          
          <div class="card-content">
            <div class="word-title-group">
              <span class="word-text">{{ item.sentence_en }}</span>
              @if (item.isKnown) {
              <nz-tag [nzColor]="'success'">å·²æŒæ¡</nz-tag>
              }
            </div>

            <div class="phonetic-group">
              <span class="phonetic">ğŸ‡ºğŸ‡¸ <nz-icon class="sound-icon" nzType="muted" nzTheme="outline" appHoverSound
                  [hoverTime]="500" (hoverTimeout)="handleSound(item, 'us')"></nz-icon></span>
              <span class="phonetic">ğŸ‡¬ğŸ‡§ <nz-icon class="sound-icon" nzType="muted" nzTheme="outline" appHoverSound
                  [hoverTime]="500" (hoverTimeout)="handleSound(item, 'uk')"></nz-icon></span>
            </div>

            <div class="definition">{{ item.sentence_zh }}</div>
          </div>

          <div class="card-footer">
            @if(!isCustom) {
            <button nz-button nzType="text" [nzType]="item.isKnown ? 'primary' : 'default'" [nzGhost]="item.isKnown"
              (click)="$event.stopPropagation();markAsKnown(item)" nz-tooltip nzTooltipTitle="æ ‡è®°ä¸ºè®¤è¯†">
              <span nz-icon nzType="check"></span> è®¤è¯†
            </button>

            <button nz-button nzType="default" nzDanger (click)="$event.stopPropagation();markAsUnknown(item)" nz-tooltip
              nzTooltipTitle="æ ‡è®°ä¸ºä¸è®¤è¯†">
              <span nz-icon nzType="close"></span> ä¸è®¤è¯†
            </button>
            }

            <button nz-button nzType="primary" (click)="$event.stopPropagation();openPractice(item)">
              <span nz-icon nzType="edit"></span> ç»ƒä¸€ç»ƒ
            </button>

            @if(isCustom) {
            <button nz-button nzType="default" nzDanger (click)="$event.stopPropagation();deleteCustomSentence(item)"
              nz-tooltip nzTooltipTitle="åˆ é™¤">
              <span nz-icon nzType="delete"></span> åˆ é™¤
            </button>
            }
          </div>
        </nz-card>
      </div>
      }

      @defer (on timer(20ms)) {
      @for (item of remainingSentences; track item.id) {
      <div nz-col [nzXs]="24" [nzSm]="12" [nzMd]="12" [nzLg]="8" [nzXl]="8" [nzXXl]="8">
        <nz-card 
          [class.is-known]="item.isKnown" 
          [nzHoverable]="true"
          appHoverSound 
          (soundClick)="handleSound(item, 'us')">
          
          <div class="card-content">
            <div class="word-title-group">
              <span class="word-text">{{ item.sentence_en }}</span>
              @if (item.isKnown) {
              <nz-tag [nzColor]="'success'">å·²æŒæ¡</nz-tag>
              }
            </div>

            <div class="phonetic-group">
              <span class="phonetic">ğŸ‡ºğŸ‡¸ <nz-icon class="sound-icon" nzType="muted" nzTheme="outline" appHoverSound
                  [hoverTime]="500" (hoverTimeout)="handleSound(item, 'us')"></nz-icon></span>
              <span class="phonetic">ğŸ‡¬ğŸ‡§ <nz-icon class="sound-icon" nzType="muted" nzTheme="outline" appHoverSound
                  [hoverTime]="500" (hoverTimeout)="handleSound(item, 'uk')"></nz-icon></span>
            </div>

            <div class="definition">{{ item.sentence_zh }}</div>
          </div>

          <div class="card-footer">
            @if(!isCustom) {
            <button nz-button nzType="text" [nzType]="item.isKnown ? 'primary' : 'default'" [nzGhost]="item.isKnown"
              (click)="$event.stopPropagation();markAsKnown(item)" nz-tooltip nzTooltipTitle="æ ‡è®°ä¸ºè®¤è¯†">
              <span nz-icon nzType="check"></span> è®¤è¯†
            </button>

            <button nz-button nzType="default" nzDanger (click)="$event.stopPropagation();markAsUnknown(item)" nz-tooltip
              nzTooltipTitle="æ ‡è®°ä¸ºä¸è®¤è¯†">
              <span nz-icon nzType="close"></span> ä¸è®¤è¯†
            </button>
            }

            <button nz-button nzType="primary" (click)="$event.stopPropagation();openPractice(item)">
              <span nz-icon nzType="edit"></span> ç»ƒä¸€ç»ƒ
            </button>

            @if(isCustom) {
            <button nz-button nzType="default" nzDanger (click)="$event.stopPropagation();deleteCustomSentence(item)"
              nz-tooltip nzTooltipTitle="åˆ é™¤">
              <span nz-icon nzType="delete"></span> åˆ é™¤
            </button>
            }
          </div>
        </nz-card>
      </div>
      }
      }
    </div>
  </div>

  <nz-modal [(nzVisible)]="isPracticeVisible" [nzTitle]="'å£è¯­ç»ƒä¹ '" (nzOnCancel)="handlePracticeCancel()"
    (nzOnOk)="handlePracticeOk()">
    <ng-container *nzModalContent>
      <p class="modal-desc">é‡Šä¹‰ï¼š{{ practiceWord?.sentence_zh }}</p>
      <input nz-input placeholder="è¯·åœ¨æ­¤è¾“å…¥..." [(ngModel)]="practiceInput" (keydown.enter)="handlePracticeOk()" />
    </ng-container>
  </nz-modal>
</div>